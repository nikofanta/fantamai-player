<!DOCTYPE html>
<html lang="it">
<head>
  <!-- [1] HEAD / META -->
  <link rel="icon" href="./favicon.ico">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#e38b1f">
  <title>Project "fantamAI"</title>
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="manifest.json">

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-6JZE25R0LP"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-6JZE25R0LP');
  </script>
</head>

<body>
  <!-- [2] UPDATE NOTIFICATION BANNER -->
  <div id="updateBanner" class="update-banner hidden">
    <span>ðŸŽ‰ New version available!</span>
    <button id="updateBtn" class="update-btn">Update Now</button>
  </div>

  <!-- [2.5] INSTALL PWA BANNER -->
  <div id="installBanner" class="install-banner hidden">
    <span>ðŸ“± Install fantamAI Player for a better experience!</span>
    <div class="install-actions">
      <button id="installBtn" class="install-btn">Install</button>
      <button id="dismissInstallBtn" class="dismiss-btn">âœ•</button>
    </div>
  </div>

  <!-- [3] SECRET MODE POPUP -->
  <div id="secretModePopup" class="secret-popup hidden">
    <div class="secret-popup-content">
      <div class="secret-icon">ðŸ”“</div>
      <h3>Secret Mode Activated!</h3>
      <p>Hidden tracks are now visible</p>
    </div>
  </div>

  <!-- [4] CONTAINER PRINCIPALE -->
  <div class="container">

    <!-- [4] BLOCCO CANZONE CORRENTE -->
    <div id="currentTrackContainer">

      <!-- [4.1] COVER + ONDE -->
      <div class="cover-wrapper">
        <div class="cover-inner">
          <img id="currentCover" src="" alt="Cover">
          
          <!-- Onde radio animate -->
          <div class="waves-overlay">
            <svg class="waves" viewBox="0 0 1200 200" preserveAspectRatio="none">
              <path d="M0 100 Q300 20 600 100 T1200 100" />
            </svg>
          </div>
        </div>
      </div>

      <!-- [4.2] TITOLO -->
      <div class="title-wrapper">
        <h2 id="currentTitle" aria-live="polite"></h2>
      </div>
      
      <!-- [4.3] LYRICS TOGGLE BUTTON -->
      <button id="lyricsToggleBtn" class="lyrics-toggle-btn" aria-label="Toggle lyrics display" title="Mostra/Nascondi testo">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <!-- Speech bubble -->
          <path d="M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4V4c0-1.1-.9-2-2-2z" stroke="currentColor" stroke-width="2" fill="none" stroke-linejoin="round"/>
          <!-- Text lines -->
          <line x1="7" y1="7" x2="17" y2="7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <line x1="7" y1="11" x2="17" y2="11" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <line x1="7" y1="15" x2="13" y2="15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>

      <!-- [4.3] LYRICS OVERLAY -->
      <div class="lyrics-nav-container">
        <div id="lyricsContainer" class="lyrics-container" role="region" aria-label="Synchronized lyrics">
          <div id="prevLyric" class="lyric-line lyric-prev" aria-hidden="true"></div>
          <div id="currentLyric" class="lyric-line lyric-current" aria-live="assertive">
            Testo non disponibile
          </div>
          <div id="nextLyric" class="lyric-line lyric-next" aria-hidden="true"></div>
        </div>
      </div>

      <!-- [4.4] STATUS OVERLAY -->
      <div id="statusOverlay" class="status-overlay">
        <div class="spinner" id="spinner"></div>
        <span id="statusText">Pronto</span>
      </div>
    </div>

    <!-- [6] PLAYLIST HEADER -->
    <div class="playlist-header">
      <h3>Brani <span id="trackCounter">(0)</span></h3>
    </div>

    <!-- [8] PLAYLIST -->
    <ul id="trackList" role="list" aria-label="Available tracks"></ul>
  </div>

  <!-- [9] NAVIGATION FOOTER -->
  <div class="navigation-footer">
    <div class="footer-controls">
      <div class="footer-left">
        <button id="prevBtn" class="footer-nav-btn" aria-label="Previous track">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M11 6L6 12l5 6V6z"/>
            <path d="M18 6l-5 6 5 6V6z"/>
          </svg>
        </button>
        <button id="nextBtn" class="footer-nav-btn" aria-label="Next track">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M13 6l5 6-5 6V6z"/>
            <path d="M6 6l5 6-5 6V6z"/>
          </svg>
        </button>
      </div>
      <div class="footer-center">
        <div class="version-info">
          <small>v<span id="appVersion">3.3.27</span></small>
        </div>
      </div>
      <div class="footer-right">
        <button id="onlyFavsChk" class="favs-heart-btn" aria-label="Show only favorite tracks" title="Usa questo cuore per selezionare solo i tuoi preferiti!">
          <svg width="24" height="24" viewBox="0 0 24 24">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
          </svg>
        </button>
        <button id="showDraftsChk" class="draft-cruet-btn" aria-label="Show draft tracks" title="Usa questa ampolla per mostrare/nascondere gli esperimenti!">
          <svg width="24" height="24" viewBox="0 0 24 24">
            <!-- Flask neck -->
            <path d="M10 2h4v6l4 8c0.5 1 0.5 2 0 3s-1.5 2-3 2H9c-1.5 0-2.5-1-3-2s-0.5-2 0-3l4-8V2z" stroke-linejoin="round"/>
            <!-- Flask base when filled -->
            <path class="flask-fill" d="M10 8l4 8c0.5 1 0.5 2 0 3s-1.5 2-3 2H9c-1.5 0-2.5-1-3-2s-0.5-2 0-3l4-8z"/>
          </svg>
        </button>
        <span id="secretModeIndicator" class="secret-indicator hidden">ðŸ”“</span>
      </div>
    </div>
    <audio id="audioPlayer" controls controlslist="nodownload noplaybackrate" aria-label="Audio player"></audio>
  </div>

  <!-- [10] SCRIPT -->
  <script src="script.js"></script>
</body>
</html>

